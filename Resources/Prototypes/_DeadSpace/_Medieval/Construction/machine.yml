- type: constructionGraph
  id: MedievalMachine
  start: start
  graph:
    - node: start
      entity: MedievalUnfinishedMachineFrame
      actions:
        - !type:EmptyAllContainers
      edges:
        - to: machineFrame
          conditions:
            - !type:EntityAnchored
          steps:
            - material: MedievalManaCrystal1
              amount: 1
              doAfter: 2.5
        - to: destroyedMachineFrame
          steps:
            - material: MedievalBoard1
              amount: 1
              doAfter: 2.5

    - node: machineFrame
      entity: MedievalMachineFrame
      actions:
        - !type:AddContainer
          container: machine_parts
        - !type:AddContainer
          container: machine_board
        - !type:MachineFrameRegenerateProgress
      edges:
        - to: machine
          conditions:
            - !type:EntityAnchored
            - !type:MachineFrameComplete
          steps:
            - tool: Screwing
              doAfter: 0.5

        - to: machineFrame
          conditions:
            - !type:EntityAnchored
            - !type:ContainerNotEmpty
              container: machine_board
          steps:
            - tool: Prying
              doAfter: 2
              completed:
                - !type:EmptyAllContainers
                - !type:MachineFrameRegenerateProgress

        - to: start
          conditions:
            - !type:EntityAnchored
            - !type:ContainerEmpty
              container: machine_board
              examineText: construction-condition-machine-container-empty
          steps:
            - tool: Cutting
              doAfter: 0.25

    - node: machine
      entity: !type:BoardNodeEntity { container: machine_board }

    - node: destroyedMachineFrame
      entity: MedievalMachineFrameDestroyed
      edges:
        - to: start
          steps:
            - tool: Welding
              doAfter: 5
          completed:
            - !type:SpawnPrototype
              prototype: MedievalBoard1
              amount: 1
            - !type:DeleteEntity {}